<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/images/favicon.ico"/><title>Refactor Modal – Complete Intro to React v8</title><meta name="description" content="Come learn React from Brian Holt, a veteran React.js developer on Frontend Masters"/><meta name="og:description" content="Come learn React from Brian Holt, a veteran React.js developer on Frontend Masters"/><meta name="og:title" content="Refactor Modal – Complete Intro to React v8"/><meta name="og:image" content="/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/3dae6366d30e4e57.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3dae6366d30e4e57.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-fd82975a6094609f.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-18053c3f67c4d467.js" defer=""></script><script src="/_next/static/chunks/pages/_app-39b20433cd23d432.js" defer=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-327376b1b9678381.js" defer=""></script><script src="/_next/static/ZUSqRzmCYYtXOVCRJrkjn/_buildManifest.js" defer=""></script><script src="/_next/static/ZUSqRzmCYYtXOVCRJrkjn/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Complete Intro to React v8</a></h1><div class="navbar-info"><a href="https://frontendmasters.com/workshops/complete-react-v8/" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><blockquote>
<p>Please start with a fresh copy of this app: <a href="https://github.com/btholt/citr-v8-project/tree/master/14-context">Adopt Me!</a></p>
</blockquote>
<p>TypeScript is a thin layer on top of JavaScript that adds the power of a static checker to your code base. This means you&#39;ll have another layer of protection helping protect you against dumb bugs like <code>var x = 5; x.toUpperCase()</code>: things that a normal linter can&#39;t find but a type system can.</p>
<p>This is going to be a brief intro: how to set it up and get going with it. If you want more TypeScript goodness, check out <a href="https://frontendmasters.com/courses/typescript-v3/">Mike North&#39;s course</a>. If you want further depth on specifically React and TypeScript, check out <a href="https://frontendmasters.com/courses/react-typescript/">Steve Kinney&#39;s course</a>. Both are phenomenal teachers.</p>
<ol>
<li>First thing, <code>npm install -D typescript@4.8.4</code>.</li>
<li>Then run <code>npx tsc --init</code>. <code>npx</code> will run the TypeScript tool directly from your node_modules and init your project for you. You&#39;ll see now a tsconfig.json. We don&#39;t need to set up anything else since Vite already knows how to handle TypeScript files.</li>
<li>Open your new <code>tsconfig.json</code> file and uncomment the <code>jsx</code> field. This lets TypeScript that you&#39;re writing React.</li>
<li>Then update the target to be <code>ES2022</code> so that you can use async / await and promises and all that.</li>
<li>Uncomment the <code>&quot;module&quot;</code> line line and make it <code>&quot;module&quot;: &quot;ES2022&quot;</code>.</li>
<li>Uncomment the <code>&quot;moduleResolution&quot;: &quot;node&quot;</code> line</li>
</ol>
<p>You&#39;ll end up with something like this:</p>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;target&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES2022&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;jsx&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;react-jsx&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;module&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ES2022&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;moduleResolution&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;node&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;esModuleInterop&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;forceConsistentCasingInFileNames&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;strict&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;skipLibCheck&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>Next we need to install the types for our project. Not all projects are written in TypeScript so another project, DefinitelyTyped, provides third party types for your library. In order to install these types, run <code>npm install -D @types/react@18.0.21 @types/react-dom@18.0.6</code>. This will grab all these type definitions.</p>
<p>This is a migration: we&#39;re going to migrate one file at a time to being a TypeScript file. As we migrate each file, we&#39;ll change it from being a <code>.js</code> or <code>.jsx</code> file to a <code>.ts</code> or a <code>.tsx</code> file. Let&#39;s start with Modal.tsx (make sure you rename it to <code>.tsx</code>).</p>
<pre><code class="hljs language-typescript"><span class="hljs-keyword">import</span> { useEffect, useRef, <span class="hljs-title class_">MutableRefObject</span>, <span class="hljs-title class_">ReactElement</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { createPortal } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;

<span class="hljs-keyword">const</span> <span class="hljs-title function_">Modal</span> = (<span class="hljs-params">{ children }: { children: ReactElement }</span>) =&gt; {
  <span class="hljs-keyword">const</span> <span class="hljs-attr">elRef</span>: <span class="hljs-title class_">MutableRefObject</span>&lt;<span class="hljs-title class_">HTMLDivElement</span> | <span class="hljs-literal">null</span>&gt; = <span class="hljs-title function_">useRef</span>(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">if</span> (!elRef.<span class="hljs-property">current</span>) {
    elRef.<span class="hljs-property">current</span> = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&quot;div&quot;</span>);
  }

  <span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> modalRoot = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;modal&quot;</span>);
    <span class="hljs-keyword">if</span> (!modalRoot || !elRef.<span class="hljs-property">current</span>) {
      <span class="hljs-keyword">return</span>;
    }
    modalRoot.<span class="hljs-title function_">appendChild</span>(elRef.<span class="hljs-property">current</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function">() =&gt;</span> {
      <span class="hljs-keyword">if</span> (elRef.<span class="hljs-property">current</span>) {
        modalRoot.<span class="hljs-title function_">removeChild</span>(elRef.<span class="hljs-property">current</span>);
      }
    };
  }, []);

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">createPortal</span>(<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>, elRef.<span class="hljs-property">current</span>);
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title class_">Modal</span>;
</code></pre>
<p>Fairly similar. We could have made it so the ref could never potentially be null by instantiating it inside the ref. Yes, this will create a new DOM node every time you render, and no that&#39;s probably not a big deal for the most part, but it would bother me and so let&#39;s do it the same way we did it before. Now we have do null checks anywhere we access <code>elRef.current</code>.</p>
<p>Then we have to do a null check on modalRoot inside the effect because that could be null too. TypeScript will force you to do this a lot, but it will save you run time errors. Notice we didn&#39;t write many types down (just children and the ref type): TypeScript is smart enough to figure out types on its own most of the time.</p>
<p>Notice we&#39;re importing the <code>ReactElement</code> and <code>MutableRefObject</code> type from React. Types can be exported from libraries and modules.</p>
<p>We&#39;re also using a generic here. Refs can be one of many things. In this case our generic for the <code>MutableRefObject</code> is either <code>null</code> or <code>HTMLDivElement</code>. This is basically a parameter to the <code>MutableRefObject</code> to tell it how to structure itself.</p>
</div><div class="lesson-links"><a href="/lessons/low-priority-rerendering/transitions" class="prev">← Previous</a><a href="/lessons/typescript/typescript-and-eslint" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="32" viewBox="0 0 40 32"><defs><clipPath id="clip-twitter-social"><rect width="40" height="32"></rect></clipPath></defs><g id="twitter-social" clip-path="url(#clip-twitter-social)"><g id="Group_269" data-name="Group 269" transform="translate(-230.23 -1140.849)"><path id="Path_419" data-name="Path 419" d="M266.12,1148.861v1.035a23.092,23.092,0,0,1-1.507,8.1,24.08,24.08,0,0,1-4.475,7.381,22.175,22.175,0,0,1-7.306,5.4,24.129,24.129,0,0,1-10,2.07,23.7,23.7,0,0,1-6.667-.945,22.83,22.83,0,0,1-5.936-2.655q.959.091,1.963.09a16.518,16.518,0,0,0,5.434-.9,17.111,17.111,0,0,0,4.749-2.52,8.275,8.275,0,0,1-4.749-1.643,7.8,7.8,0,0,1-2.877-3.983,8.268,8.268,0,0,0,1.507.135,8.58,8.58,0,0,0,2.146-.27,8.16,8.16,0,0,1-5.685-4.344,8.326,8.326,0,0,1-.89-3.578v-.135a7.775,7.775,0,0,0,3.744,1.035,8.183,8.183,0,0,1-2.671-2.9,7.817,7.817,0,0,1-.982-3.848,7.948,7.948,0,0,1,1.1-4.05,23.53,23.53,0,0,0,16.895,8.46,9.221,9.221,0,0,1-.183-1.845,7.787,7.787,0,0,1,1.1-4.05,8.216,8.216,0,0,1,2.991-2.948,7.991,7.991,0,0,1,4.087-1.1,8.184,8.184,0,0,1,5.982,2.566,16.087,16.087,0,0,0,5.205-1.98,7.784,7.784,0,0,1-1.393,2.588,8.4,8.4,0,0,1-2.215,1.913,16.856,16.856,0,0,0,4.749-1.305A17.032,17.032,0,0,1,266.12,1148.861Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul></footer></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"description":""},"html":"\u003cblockquote\u003e\n\u003cp\u003ePlease start with a fresh copy of this app: \u003ca href=\"https://github.com/btholt/citr-v8-project/tree/master/14-context\"\u003eAdopt Me!\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eTypeScript is a thin layer on top of JavaScript that adds the power of a static checker to your code base. This means you\u0026#39;ll have another layer of protection helping protect you against dumb bugs like \u003ccode\u003evar x = 5; x.toUpperCase()\u003c/code\u003e: things that a normal linter can\u0026#39;t find but a type system can.\u003c/p\u003e\n\u003cp\u003eThis is going to be a brief intro: how to set it up and get going with it. If you want more TypeScript goodness, check out \u003ca href=\"https://frontendmasters.com/courses/typescript-v3/\"\u003eMike North\u0026#39;s course\u003c/a\u003e. If you want further depth on specifically React and TypeScript, check out \u003ca href=\"https://frontendmasters.com/courses/react-typescript/\"\u003eSteve Kinney\u0026#39;s course\u003c/a\u003e. Both are phenomenal teachers.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eFirst thing, \u003ccode\u003enpm install -D typescript@4.8.4\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eThen run \u003ccode\u003enpx tsc --init\u003c/code\u003e. \u003ccode\u003enpx\u003c/code\u003e will run the TypeScript tool directly from your node_modules and init your project for you. You\u0026#39;ll see now a tsconfig.json. We don\u0026#39;t need to set up anything else since Vite already knows how to handle TypeScript files.\u003c/li\u003e\n\u003cli\u003eOpen your new \u003ccode\u003etsconfig.json\u003c/code\u003e file and uncomment the \u003ccode\u003ejsx\u003c/code\u003e field. This lets TypeScript that you\u0026#39;re writing React.\u003c/li\u003e\n\u003cli\u003eThen update the target to be \u003ccode\u003eES2022\u003c/code\u003e so that you can use async / await and promises and all that.\u003c/li\u003e\n\u003cli\u003eUncomment the \u003ccode\u003e\u0026quot;module\u0026quot;\u003c/code\u003e line line and make it \u003ccode\u003e\u0026quot;module\u0026quot;: \u0026quot;ES2022\u0026quot;\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eUncomment the \u003ccode\u003e\u0026quot;moduleResolution\u0026quot;: \u0026quot;node\u0026quot;\u003c/code\u003e line\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eYou\u0026#39;ll end up with something like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e\u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;compilerOptions\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;target\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;ES2022\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;jsx\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react-jsx\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;module\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;ES2022\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;moduleResolution\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;node\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;esModuleInterop\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;forceConsistentCasingInFileNames\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;strict\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;skipLibCheck\u0026quot;\u003c/span\u003e\u003cspan class=\"hljs-punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e\u003cspan class=\"hljs-keyword\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n  \u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"hljs-punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNext we need to install the types for our project. Not all projects are written in TypeScript so another project, DefinitelyTyped, provides third party types for your library. In order to install these types, run \u003ccode\u003enpm install -D @types/react@18.0.21 @types/react-dom@18.0.6\u003c/code\u003e. This will grab all these type definitions.\u003c/p\u003e\n\u003cp\u003eThis is a migration: we\u0026#39;re going to migrate one file at a time to being a TypeScript file. As we migrate each file, we\u0026#39;ll change it from being a \u003ccode\u003e.js\u003c/code\u003e or \u003ccode\u003e.jsx\u003c/code\u003e file to a \u003ccode\u003e.ts\u003c/code\u003e or a \u003ccode\u003e.tsx\u003c/code\u003e file. Let\u0026#39;s start with Modal.tsx (make sure you rename it to \u003ccode\u003e.tsx\u003c/code\u003e).\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { useEffect, useRef, \u003cspan class=\"hljs-title class_\"\u003eMutableRefObject\u003c/span\u003e, \u003cspan class=\"hljs-title class_\"\u003eReactElement\u003c/span\u003e } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { createPortal } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;react-dom\u0026quot;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eModal\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003e{ children }: { children: ReactElement }\u003c/span\u003e) =\u0026gt; {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eelRef\u003c/span\u003e: \u003cspan class=\"hljs-title class_\"\u003eMutableRefObject\u003c/span\u003e\u0026lt;\u003cspan class=\"hljs-title class_\"\u003eHTMLDivElement\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e\u0026gt; = \u003cspan class=\"hljs-title function_\"\u003euseRef\u003c/span\u003e(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\n  \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e) {\n    elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecreateElement\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;div\u0026quot;\u003c/span\u003e);\n  }\n\n  \u003cspan class=\"hljs-title function_\"\u003euseEffect\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e modalRoot = \u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026quot;modal\u0026quot;\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (!modalRoot || !elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e) {\n      \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e;\n    }\n    modalRoot.\u003cspan class=\"hljs-title function_\"\u003eappendChild\u003c/span\u003e(elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e);\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e) {\n        modalRoot.\u003cspan class=\"hljs-title function_\"\u003eremoveChild\u003c/span\u003e(elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e);\n      }\n    };\n  }, []);\n\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003ecreatePortal\u003c/span\u003e(\u003cspan class=\"language-xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e{children}\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e, elRef.\u003cspan class=\"hljs-property\"\u003ecurrent\u003c/span\u003e);\n};\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eModal\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFairly similar. We could have made it so the ref could never potentially be null by instantiating it inside the ref. Yes, this will create a new DOM node every time you render, and no that\u0026#39;s probably not a big deal for the most part, but it would bother me and so let\u0026#39;s do it the same way we did it before. Now we have do null checks anywhere we access \u003ccode\u003eelRef.current\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThen we have to do a null check on modalRoot inside the effect because that could be null too. TypeScript will force you to do this a lot, but it will save you run time errors. Notice we didn\u0026#39;t write many types down (just children and the ref type): TypeScript is smart enough to figure out types on its own most of the time.\u003c/p\u003e\n\u003cp\u003eNotice we\u0026#39;re importing the \u003ccode\u003eReactElement\u003c/code\u003e and \u003ccode\u003eMutableRefObject\u003c/code\u003e type from React. Types can be exported from libraries and modules.\u003c/p\u003e\n\u003cp\u003eWe\u0026#39;re also using a generic here. Refs can be one of many things. In this case our generic for the \u003ccode\u003eMutableRefObject\u003c/code\u003e is either \u003ccode\u003enull\u003c/code\u003e or \u003ccode\u003eHTMLDivElement\u003c/code\u003e. This is basically a parameter to the \u003ccode\u003eMutableRefObject\u003c/code\u003e to tell it how to structure itself.\u003c/p\u003e\n","slug":"refactor-modal","title":"Refactor Modal","section":"TypeScript","icon":"pencil-ruler","filePath":"/home/runner/work/complete-intro-to-react-v8/complete-intro-to-react-v8/lessons/13-typescript/A-refactor-modal.md","nextSlug":"/lessons/typescript/typescript-and-eslint","prevSlug":"/lessons/low-priority-rerendering/transitions"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"typescript","slug":"refactor-modal"},"buildId":"ZUSqRzmCYYtXOVCRJrkjn","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>